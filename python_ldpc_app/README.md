# LDPC Application - Python Version

Консольное приложение для работы с LDPC (Low-Density Parity-Check) кодами.

## Структура проекта

- `constants.py` - Константы
- `enums.py` - Перечисления (Result, InterleaverType, LDPCDecoderType)
- `generator.py` - Генератор случайных чисел и битовых последовательностей
- `matrix.py` - Класс для работы с матрицами
- `data_buffer.py` - Буфер данных для кодирования/декодирования
- `encoder_decoder_data.py` - Данные кодера/декодера
- `channel.py` - Модель канала связи
- `spa_decoder.py` - Декодер Sum-Product Algorithm
- `settings.py` - Настройки приложения
- `interleavers.py` - Классы интерливеров
- `utils.py` - Утилиты для чтения матриц
- `main.py` - Главный файл консольного приложения

## Использование

### Базовый запуск

```bash
python main.py --matrix <путь_к_файлу_матрицы>
```

### Примеры

```bash
# Базовый пример с 100 блоками
python main.py --matrix ../Channel_Codes_Database/BCH_7_4_1_strip.alist.txt

# С дополнительными параметрами
python main.py --matrix ../Channel_Codes_Database/BCH_7_4_1_strip.alist.txt \
    --blocks 50 \
    --iterations 10 \
    --interleaver random \
    --decoder sumproduct \
    --ber --fer

# С настройками SNR диапазона
python main.py --matrix ../Channel_Codes_Database/BCH_7_4_1_strip.alist.txt \
    --initial-snr 0.0 \
    --end-snr 5.0 \
    --step-snr 0.5 \
    --ber --fer

# С настройками канала и помехи
python main.py --matrix ../Channel_Codes_Database/BCH_7_4_1_strip.alist.txt \
    --mode 2 \
    --initial-snr 1.0 \
    --end-snr 4.0 \
    --step-snr 0.5 \
    --interference-snr 1.5 \
    --p 0.2 \
    --ber --fer

# С многопоточностью (4 потока для ускорения обработки)
python main.py --matrix ../Channel_Codes_Database/BCH_7_4_1_strip.alist.txt \
    --blocks 1000 \
    --threads 4 \
    --ber --fer
```

### Параметры командной строки

- `--matrix, -m` - Путь к файлу матрицы проверки четности (обязательный)
- `--blocks, -b` - Количество блоков для обработки (по умолчанию: 100)
- `--iterations, -i` - Максимальное количество итераций декодера (по умолчанию: 5)
- `--interleaver, -il` - Тип интерливера: none, regular, random, srandom (по умолчанию: none)
- `--decoder, -d` - Тип декодера: bitflipping, sumproduct (по умолчанию: sumproduct)
- `--speed, -s` - Скорость передачи (по умолчанию: 1.0)
- `--initial-snr` - Начальное SNR в дБ (по умолчанию: 0.0)
- `--end-snr` - Конечное SNR в дБ (по умолчанию: 5.0)
- `--step-snr` - Шаг SNR в дБ (по умолчанию: 0.5)
- `--interference-snr` - SNR помехи в дБ для режимов 2 и 3 (по умолчанию: 1.0)
- `--mode` - Режим канала: 1=АБГШ, 2=АБГШ+помеха в части полосы, 3=АБГШ+встречная помеха (по умолчанию: 1)
- `--p` - Параметр p (gamma) для режимов 2 и 3 (по умолчанию: 0.1)
- `--modulation, -mod` - Тип модуляции: 1=ФМ-2, 2=ФМ-4 (по умолчанию: 1)
- `--s-param` - Параметр S для S-Random интерливера (по умолчанию: 2)
- `--ber` - Вычислять BER (Bit Error Rate)
- `--fer` - Вычислять FER (Frame Error Rate)
- `--normalized-llr` - Вычислять нормализованный LLR
- `--threads, -t` - Количество потоков для параллельной обработки блоков (по умолчанию: 1)

### Формат файла матрицы

Файл матрицы должен быть в формате alist:
- Первая строка: количество столбцов и строк
- Вторая строка: количество единиц в каждой строке и столбце
- Далее: индексы единиц для каждого столбца и строки

## Требования

- Python 3.6 или выше
- scipy >= 1.9.0
- numpy >= 1.21.0

### Установка зависимостей

```bash
pip install -r requirements.txt
```

или

```bash
pip install scipy numpy
```

## Оптимизации

Приложение использует несколько методов оптимизации для ускорения работы:

### Разреженные матрицы
- Матрицы проверки четности хранятся в разреженном формате (scipy.sparse)
- Операции кодирования и декодирования оптимизированы для разреженных матриц
- Это значительно ускоряет работу с большими LDPC кодами

### Многопроцессность
- Приложение поддерживает параллельную обработку блоков с помощью многопроцессности (ProcessPoolExecutor)
- Используйте параметр `--threads` для указания количества процессов (название параметра сохранено для совместимости)
- Рекомендуется использовать количество процессов, равное количеству ядер процессора
- Пример: `--threads 4` для использования 4 процессов
- **Преимущества ProcessPoolExecutor:**
  - Обходит GIL (Global Interpreter Lock), что критично для CPU-bound задач
  - Эффективно использует все ядра процессора
  - Идеально подходит для CPU-intensive операций (декодирование LDPC)
- **Примечание:** Многопроцессность эффективна при обработке большого количества блоков (1000+)
- **Технические детали:**
  - Все объекты автоматически сериализуются (pickle) для передачи между процессами
  - Каждый процесс имеет свою память, поэтому lock не требуется
  - Для Windows требуется запуск через `if __name__ == '__main__'` (уже реализовано)
